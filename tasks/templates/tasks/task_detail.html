{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>{{ task.title }}</h2>
    <p><strong>–û–ø–∏—Å:</strong> {{ task.description }}</p>
    <p><strong>–î–∞—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:</strong> {{ task.due_date }}</p>
    <p><strong>–°—Ç–≤–æ—Ä–µ–Ω–æ:</strong> {{ task.created }}</p>
    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> {{ task.is_completed|yesno:"–ó–∞–≤–µ—Ä—à–µ–Ω–æ,–ù–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ" }}</p>
    <hr>

    <h4>–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ:</h4>
    {% if comments %}
        {% for comment in comments %}
            <div class="card mb-3">
                <div class="card-body">
                    <p>{{ comment.text }}</p>

                    {% if comment.attachment %}
                        {% with comment.attachment.url|lower as url %}
                            {% if ".jpg" in url or ".jpeg" in url or ".png" in url or ".gif" in url %}
                                <img src="{{ comment.attachment.url }}" alt="Image" class="img-fluid rounded" style="max-height: 300px;">
                            {% endif %}
                            <a href="{{ comment.attachment.url }}" target="_blank" class="btn btn-sm btn-outline-primary mt-2">
                                üìé –í—ñ–¥–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–µ–Ω–Ω—è
                            </a>
                        {% endwith %}
                    {% endif %}

                    <p class="text-muted mt-2">
                        –ê–≤—Ç–æ—Ä: {{ comment.author }} | {{ comment.created_at|date:"d E Y —Ä. H:i" }}
                    </p>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p>–ü–æ–∫–∏ –Ω–µ–º–∞—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤.</p>
    {% endif %}

    <hr>
    <h5>–î–æ–¥–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä:</h5>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <button type="submit" class="btn btn-primary mt-2">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
    </form>
</div>
{% endblock %}
